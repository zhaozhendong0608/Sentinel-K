---
description: 📡 [Planning] 需求审计与依赖雷达 (Planning & Dependency Radar)
---

# 📡 02_需求雷达 (Planning Radar V2.0)

> **定位**: 将业务需求转化为带有依赖预警的“原子任务”。
> **目的**: 解决“顾头不顾尾”的修改，提前发现资源冲突，并实施 **Pizza Logic** 拆分。
> **V2升级**: 集成 `Pizza Slicing` 判定与 `Solid Asset` 触碰检测。

## Node A: 领域专家审计 & 依赖雷达 (Expert Audit & Radar)

**切换人格**: 根据用户需求关键词，扮演相应的 **Expert Role** (DBA / 安全专家 / 架构师)。

**执行审计**:
1.  **风险预警**: 指出业务风险（性能、安全、兼容性）。
2.  **Solid 资产触碰检测 (Solid Touch Check)**:
    *   🚨 **Solid-Strict**: 是否修改 `api/contracts/`, `db/migration/`, `.env`, `pom.xml`, `CI配置`? -> **需要 ADR + Approval_Hash**。
    *   ⚠️ **Solid-Regulated**: 是否修改核心 Domain Model? -> **需要 ADR_Entry**。
3.  **Pizza Logic 判定 (Slicing) `[K-PIZZA]`**:
    *   **阈值**: 预估变更内容 **> 3 个文件** 或 **> 100 行代码**。
    *   **动作**: 若是，强制拆分为 `Sub-Intent`。
        *   **默认 (2片)**: `S1-Bone` + `S2-Muscle`。
        *   **扩展 (3片)**: `S1-Bone` + `S2-Stub` + `S3-Muscle` (高风险推荐)。

## Node B: 产出 Planning 工件

请生成标准化的 `Planning Output` (可复制)：

```markdown
### 📡 Planning Output (Radar)
- **Intent**: [Goal + Scope + Constraints + DoD]
- **Pizza_Info**:
  - Triggered: [Yes/No]
  - Slices: [列出分片计划，如 S1-Bone/S2-Muscle 或 S1-Bone/S2-Stub/S3-Muscle]
- **Solid_Touch**:
  - Strict: [Files...] -> Requires ADR-[ID] + **Approval_Hash**
  - Regulated: [Files...] -> Requires **ADR_Entry**
- **Task_List**:
  - T1: [最小可验证任务]
  - T2: ...
- **Dependency_Map**: [Upstream/Downstream 模块]
```

## Node C: 决策点 (Decision Point)

向用户汇报：
> "指挥官，Planning 已完成。
> *   Pizza 切片: [触发/未触发]
> *   Solid 触碰: [无/有 -> 需 ADR]
> *   风险等级: [高/中/低]
>
> 请输入 **ACK** 锁定计划并进入执行阶段 (`03_受控执行`)。"
